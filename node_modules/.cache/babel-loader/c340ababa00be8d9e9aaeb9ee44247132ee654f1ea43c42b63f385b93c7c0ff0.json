{"ast":null,"code":"import _regeneratorRuntime from\"/Users/heyuting/404lab/404_project/WebApplicationProject/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/heyuting/404lab/404_project/WebApplicationProject/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/heyuting/404lab/404_project/WebApplicationProject/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,useCallback}from\"react\";import Form from\"./Form\";import ShareIcon from'@mui/icons-material/Share';import SendIcon from'@mui/icons-material/Send';import'./SinglePost.css';import axios from\"axios\";import FormData from'form-data';import{useNavigate}from'react-router-dom';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var SinglePost=function SinglePost(_ref){var author=_ref.author,postId=_ref.postId,comments=_ref.comments,description=_ref.description,image=_ref.image,handleShare=_ref.handleShare;var me=\"http://fallprojback.herokuapp.com/authors/1111111111\";var _useState=useState(0),_useState2=_slicedToArray(_useState,2),like=_useState2[0],setLike=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),name=_useState4[0],setName=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),comment=_useState6[0],setComment=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),commentError=_useState8[0],setCommentError=_useState8[1];var navigate=useNavigate();var AUTHOR_ID=author;//let is_liked = count === (like + 1);\nvar id=String(postId).split(\"/\").pop();var commentData=new FormData();var likeData=new FormData();useEffect(function(){axios.get(\"\".concat(postId,\"/likes\")).then(function(data){setLike(Number(data.data.length));}).catch(function(e){return console.log(e);});axios.get(\"\".concat(AUTHOR_ID)).then(function(data){setName(data.data.displayName);}).catch(function(e){return console.log(e);});},[like,name]);var handleLike=useCallback(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:likeData.append('context',\"Charlote likes your post.\");likeData.append('summary',AUTHOR_ID);axios.post(\"\".concat(postId,\"/likes\"),likeData).then(function(response){console.log(response);window.location.reload();}).catch(function(e){console.log(e);});case 3:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}(),[postId,AUTHOR_ID]);var toOtherUser=function toOtherUser(){if(AUTHOR_ID===me){alert(\"This is yourself!\");}else{navigate('./otherProfile',{state:{id:AUTHOR_ID}});}};var handleComment=useCallback(function(event){setComment(event.target.value);setCommentError('');},[]);var handleSend=useCallback(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();if(!comment){setCommentError(\"*Cannot send an empty comment!\");}else{commentData.append('content',comment);alert(\"\".concat(me,\"/posts/\").concat(id));axios.post(\"\".concat(me,\"/posts/\").concat(id,\"/comments\"),commentData).then(function(response){console.log(response);window.location.reload();}).catch(function(e){console.log(e);});}case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref3.apply(this,arguments);};}(),[comment]);return/*#__PURE__*/_jsxs(\"div\",{className:\"singlePost\",children:[/*#__PURE__*/_jsxs(\"a\",{className:\"userName\",onClick:function onClick(){toOtherUser();},children:[\"@\",name,\":\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"singleDes\",children:description}),/*#__PURE__*/_jsx(\"div\",{className:\"center\",children:/*#__PURE__*/_jsx(\"img\",{className:\"postImage\",src:image})}),/*#__PURE__*/_jsxs(\"div\",{className:\"postBar\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"eds\",onClick:handleShare,children:/*#__PURE__*/_jsx(ShareIcon,{})}),/*#__PURE__*/_jsx(Form,{type:\"text\",name:\"comment\",action:handleComment,placeholder:\"leave your comment\"}),/*#__PURE__*/_jsx(\"button\",{className:\"eds\",onClick:handleSend,children:/*#__PURE__*/_jsx(SendIcon,{})}),/*#__PURE__*/_jsxs(\"button\",{className:\"like\",onClick:handleLike,children:[\"Like \",like]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"flash\",children:commentError}),/*#__PURE__*/_jsxs(\"div\",{children:[\" \",comments]})]});};export default SinglePost;","map":{"version":3,"names":["React","useState","useEffect","useCallback","Form","ShareIcon","SendIcon","axios","FormData","useNavigate","SinglePost","author","postId","comments","description","image","handleShare","me","like","setLike","name","setName","comment","setComment","commentError","setCommentError","navigate","AUTHOR_ID","id","String","split","pop","commentData","likeData","get","then","data","Number","length","catch","e","console","log","displayName","handleLike","append","post","response","window","location","reload","toOtherUser","alert","state","handleComment","event","target","value","handleSend","preventDefault"],"sources":["/Users/heyuting/404lab/404_project/WebApplicationProject/src/components/Post/SinglePost.jsx"],"sourcesContent":["import React, { useState, useEffect, useCallback } from \"react\";\nimport Form from \"./Form\";\nimport ShareIcon from '@mui/icons-material/Share';\nimport SendIcon from '@mui/icons-material/Send';\nimport './SinglePost.css'\nimport axios from \"axios\";\nimport FormData from 'form-data'\nimport { useNavigate } from 'react-router-dom';\n\nconst SinglePost = ({ author, postId, comments, description, image, handleShare }) => {\n    const me = \"http://fallprojback.herokuapp.com/authors/1111111111\"\n    const [like, setLike] = useState(0);\n    const [name, setName] = useState('');\n    const [comment, setComment] = useState('');\n    const [commentError, setCommentError] = useState('');\n    const navigate = useNavigate();\n    const AUTHOR_ID = author;\n    //let is_liked = count === (like + 1);\n    let id = String(postId).split(\"/\").pop();\n    let commentData = new FormData();\n    let likeData = new FormData();\n\n    useEffect(() => {\n        axios\n            .get(`${postId}/likes`)\n            .then((data) => {\n                setLike(Number(data.data.length))\n            })\n            .catch((e) => console.log(e));\n        axios\n            .get(`${AUTHOR_ID}`)\n            .then((data) => {\n                setName(data.data.displayName)\n            })\n            .catch((e) => console.log(e));\n\n    }, [like, name])\n\n    const handleLike = useCallback(\n        async (e) => {\n            likeData.append('context', \"Charlote likes your post.\")\n            likeData.append('summary', AUTHOR_ID)\n            axios\n                .post(`${postId}/likes`, likeData)\n                .then((response) => {\n                    console.log(response);\n                    window.location.reload()\n                })\n                .catch((e) => {\n                    console.log(e);\n                });\n\n        },\n        [postId, AUTHOR_ID]\n    )\n\n    const toOtherUser = () => {\n        if (AUTHOR_ID === me) {\n            alert(\"This is yourself!\")\n        }\n        else {\n            navigate('./otherProfile', { state: { id: AUTHOR_ID } });\n        }\n    }\n\n    const handleComment = useCallback((event) => {\n        setComment(event.target.value)\n        setCommentError('')\n    }, [])\n\n    const handleSend = useCallback(async (e) => {\n        e.preventDefault()\n        if (!comment) {\n            setCommentError(\"*Cannot send an empty comment!\")\n        }\n        else {\n            commentData.append('content', comment)\n            alert(`${me}/posts/${id}`)\n            axios\n                .post(`${me}/posts/${id}/comments`, commentData)\n                .then((response) => {\n                    console.log(response);\n                    window.location.reload()\n                })\n                .catch((e) => {\n                    console.log(e);\n                });\n        }\n    }, [comment]\n    )\n\n    return (\n        <div className=\"singlePost\">\n            <a className=\"userName\" onClick={() => { toOtherUser() }}>@{name}:</a>\n            <p className=\"singleDes\">{description}</p>\n            <div className='center'>\n                <img className='postImage' src={image} />\n            </div>\n            <div className=\"postBar\">\n                <button className=\"eds\" onClick={handleShare}>\n                    <ShareIcon />\n                </button>\n                <Form\n                    type=\"text\"\n                    name=\"comment\"\n                    action={handleComment}\n                    placeholder=\"leave your comment\"\n                ></Form>\n                <button className=\"eds\" onClick={handleSend}>\n                    <SendIcon />\n                </button>\n                <button className=\"like\" onClick={handleLike}>\n                    Like {like}\n                </button>\n            </div>\n            <p className=\"flash\">{commentError}</p>\n            <div> {comments}</div>\n        </div>\n    )\n}\nexport default SinglePost"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}