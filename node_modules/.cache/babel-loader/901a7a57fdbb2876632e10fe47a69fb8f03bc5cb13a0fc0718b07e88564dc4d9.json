{"ast":null,"code":"import _regeneratorRuntime from\"/Users/heyuting/404lab/404_project/WebApplicationProject/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/heyuting/404lab/404_project/WebApplicationProject/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/heyuting/404lab/404_project/WebApplicationProject/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import DeleteIcon from'@mui/icons-material/Delete';import EditIcon from'@mui/icons-material/Edit';import SendIcon from'@mui/icons-material/Send';import React,{useState,useEffect,useCallback}from\"react\";import{useNavigate}from\"react-router-dom\";import Form from\"./Form\";import axios from\"axios\";import FormData from'form-data';import'./SinglePost.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var MySinglePost=function MySinglePost(_ref){var description=_ref.description,image=_ref.image,comments=_ref.comments,postId=_ref.postId;var navigate=useNavigate();var _useState=useState(0),_useState2=_slicedToArray(_useState,2),like=_useState2[0],setLike=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),comment=_useState4[0],setComment=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),commentError=_useState6[0],setCommentError=_useState6[1];var commentData=new FormData();var likeData=new FormData();useEffect(function(){axios.get(\"\".concat(postId,\"/likes\")).then(function(data){setLike(Number(data.data.length));}).catch(function(e){return console.log(e);});},[like]);var handleLike=function handleLike(){likeData.append('context',\"Charlote likes your post.\");likeData.append('summary',\"123456\");axios.post(\"\".concat(postId,\"/likes\"),likeData).then(function(response){console.log(response);window.location.reload();}).catch(function(e){console.log(e);});};var handleEdit=function handleEdit(){navigate(\"/Post\",{state:{id:postId}});};var handleDel=useCallback(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();axios.delete(\"\".concat(postId,\"/\")).then(function(response){console.log(response);alert(\"Delete Successfully!\");window.location.reload();}).catch(function(e){console.log(e);});case 2:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}(),[postId]);var handleComment=useCallback(function(event){setComment(event.target.value);setCommentError('');},[]);var handleSend=useCallback(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();if(!comment){setCommentError(\"*Cannot send an empty comment!\");}else{commentData.append('content',comment);axios.post(\"\".concat(postId,\"/comments\"),commentData).then(function(response){console.log(response);window.location.reload();}).catch(function(e){console.log(e);});}case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref3.apply(this,arguments);};}(),[comment,postId]);return/*#__PURE__*/_jsxs(\"div\",{className:\"singlePost\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"singleDes\",children:description}),/*#__PURE__*/_jsx(\"div\",{className:\"center\",children:/*#__PURE__*/_jsx(\"img\",{className:\"postImage\",src:image})}),/*#__PURE__*/_jsxs(\"div\",{className:\"postBar\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"eds\",onClick:handleDel,children:/*#__PURE__*/_jsx(DeleteIcon,{})}),/*#__PURE__*/_jsx(\"button\",{className:\"eds\",onClick:handleEdit,children:/*#__PURE__*/_jsx(EditIcon,{})}),/*#__PURE__*/_jsx(Form,{type:\"text\",name:\"comment\",action:handleComment,placeholder:\"leave your comment\"}),/*#__PURE__*/_jsx(\"button\",{className:\"eds\",onClick:handleSend,children:/*#__PURE__*/_jsx(SendIcon,{})}),/*#__PURE__*/_jsxs(\"button\",{className:\"like\",onClick:handleLike,children:[\"Like \",like]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"flash\",children:commentError}),/*#__PURE__*/_jsx(\"ul\",{children:comments})]});};export default MySinglePost;","map":{"version":3,"names":["DeleteIcon","EditIcon","SendIcon","React","useState","useEffect","useCallback","useNavigate","Form","axios","FormData","MySinglePost","description","image","comments","postId","navigate","like","setLike","comment","setComment","commentError","setCommentError","commentData","likeData","get","then","data","Number","length","catch","e","console","log","handleLike","append","post","response","window","location","reload","handleEdit","state","id","handleDel","preventDefault","delete","alert","handleComment","event","target","value","handleSend"],"sources":["/Users/heyuting/404lab/404_project/WebApplicationProject/src/components/Post/MySinglePost.jsx"],"sourcesContent":["import DeleteIcon from '@mui/icons-material/Delete';\nimport EditIcon from '@mui/icons-material/Edit';\nimport SendIcon from '@mui/icons-material/Send';\nimport React, { useState, useEffect, useCallback } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport Form from \"./Form\";\nimport axios from \"axios\";\nimport FormData from 'form-data'\nimport './SinglePost.css'\n\nconst MySinglePost = ({ description, image, comments, postId }) => {\n    const navigate = useNavigate();\n    const [like, setLike] = useState(0);\n    const [comment, setComment] = useState('');\n    const [commentError, setCommentError] = useState('');\n    let commentData = new FormData();\n    let likeData = new FormData();\n\n    useEffect(() => {\n        axios\n            .get(`${postId}/likes`)\n            .then((data) => {\n                setLike(Number(data.data.length))\n            })\n            .catch((e) => console.log(e));\n    }, [like])\n\n    const handleLike = () => {\n        likeData.append('context', \"Charlote likes your post.\")\n        likeData.append('summary', \"123456\")\n        axios\n            .post(`${postId}/likes`, likeData)\n            .then((response) => {\n                console.log(response);\n                window.location.reload()\n            })\n            .catch((e) => {\n                console.log(e);\n            });\n    }\n    const handleEdit = () => {\n        navigate(\"/Post\", { state: { id: postId } });\n    }\n\n    const handleDel = useCallback(\n        async (e) => {\n            e.preventDefault()\n            axios\n                .delete(`${postId}/`)\n                .then((response) => {\n                    console.log(response);\n                    alert(\"Delete Successfully!\")\n                    window.location.reload()\n                })\n                .catch((e) => {\n                    console.log(e);\n                });\n        },\n        [postId]\n    )\n\n    const handleComment = useCallback((event) => {\n        setComment(event.target.value)\n        setCommentError('')\n    }, [])\n\n    const handleSend = useCallback(async (e) => {\n        e.preventDefault()\n        if (!comment) {\n            setCommentError(\"*Cannot send an empty comment!\")\n        }\n        else {\n            commentData.append('content', comment)\n            axios\n                .post(`${postId}/comments`, commentData)\n                .then((response) => {\n                    console.log(response);\n                    window.location.reload()\n                })\n                .catch((e) => {\n                    console.log(e);\n                });\n        }\n    }, [comment, postId]\n    )\n    return (\n        <div className=\"singlePost\">\n            <p className=\"singleDes\">{description}</p>\n            <div className='center'>\n                <img className='postImage' src={image} />\n            </div>\n            <div className=\"postBar\">\n                <button className=\"eds\" onClick={handleDel}>\n                    <DeleteIcon />\n                </button>\n                <button className=\"eds\" onClick={handleEdit}>\n                    <EditIcon />\n                </button>\n                <Form\n                    type=\"text\"\n                    name=\"comment\"\n                    action={handleComment}\n                    placeholder=\"leave your comment\"\n                ></Form>\n                <button className=\"eds\" onClick={handleSend}>\n                    <SendIcon />\n                </button>\n                <button className=\"like\" onClick={handleLike}>\n                    Like {like}\n                </button>\n            </div>\n            <p className=\"flash\">{commentError}</p>\n            <ul>{comments}</ul>\n        </div>\n    )\n}\nexport default MySinglePost"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}