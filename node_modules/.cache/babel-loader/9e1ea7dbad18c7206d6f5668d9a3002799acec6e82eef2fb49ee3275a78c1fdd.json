{"ast":null,"code":"import _regeneratorRuntime from\"/Users/heyuting/404lab/404_project/WebApplicationProject/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/heyuting/404lab/404_project/WebApplicationProject/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/heyuting/404lab/404_project/WebApplicationProject/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,useCallback}from\"react\";import Form from\"./Form\";import SendIcon from'@mui/icons-material/Send';import'./SinglePost.css';import axios from\"axios\";import FormData from'form-data';import{useNavigate}from'react-router-dom';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var FriendSinglePost=function FriendSinglePost(_ref){var postId=_ref.postId,comments=_ref.comments;var _useState=useState(0),_useState2=_slicedToArray(_useState,2),like=_useState2[0],setLike=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),name=_useState4[0],setName=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),comment=_useState6[0],setComment=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),commentError=_useState8[0],setCommentError=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),authorId=_useState10[0],setAuthorId=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),description=_useState12[0],setDescription=_useState12[1];var _useState13=useState(''),_useState14=_slicedToArray(_useState13,2),image=_useState14[0],setImage=_useState14[1];var navigate=useNavigate();var commentData=new FormData();var likeData=new FormData();useEffect(function(){axios.get(\"\".concat(postId,\"/\")).then(function(data){setAuthorId(data.data.author);setDescription(data.data.description);}).catch(function(e){return console.log(e);});axios.get(\"\".concat(postId,\"/likes\")).then(function(data){setLike(Number(data.data.length));}).catch(function(e){return console.log(e);});},[authorId,description,like]);var handleLike=useCallback(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();likeData.append('context',\"Charlote likes your post.\");likeData.append('summary',authorId);axios.post(\"\".concat(postId,\"/likes\"),likeData).then(function(response){console.log(response);window.location.reload();}).catch(function(e){console.log(e);});case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}(),[authorId]);axios.get(\"\".concat(authorId)).then(function(data){setName(data.data.displayName);}).catch(function(e){return console.log(e);});var toOtherUser=function toOtherUser(){navigate('./otherProfile',{state:{id:authorId}});};var handleComment=useCallback(function(event){setComment(event.target.value);setCommentError('');},[]);var handleSend=useCallback(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();if(!comment){setCommentError(\"*Cannot send an empty comment!\");}else{commentData.append('content',comment);axios.post(\"\".concat(postId,\"/comments\"),commentData).then(function(response){console.log(response);window.location.reload();}).catch(function(e){console.log(e);});}case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref3.apply(this,arguments);};}());return/*#__PURE__*/_jsxs(\"div\",{className:\"singlePost\",children:[/*#__PURE__*/_jsxs(\"a\",{className:\"userName\",onClick:function onClick(){toOtherUser();},children:[\"@\",name,\":\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"singleDes\",children:description}),/*#__PURE__*/_jsx(\"div\",{className:\"center\",children:/*#__PURE__*/_jsx(\"img\",{className:\"postImage\",src:image})}),/*#__PURE__*/_jsxs(\"div\",{className:\"postBar\",children:[/*#__PURE__*/_jsx(Form,{type:\"text\",name:\"comment\",onchange:handleComment,placeholder:\"leave your comment\"}),/*#__PURE__*/_jsx(\"button\",{className:\"eds\",onClick:handleSend,children:/*#__PURE__*/_jsx(SendIcon,{})}),/*#__PURE__*/_jsxs(\"button\",{className:\"like\",onClick:handleLike,children:[\"Like \",like]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"flash\",children:commentError}),/*#__PURE__*/_jsxs(\"div\",{children:[\" \",comments]})]});};export default FriendSinglePost;","map":{"version":3,"names":["React","useState","useEffect","useCallback","Form","SendIcon","axios","FormData","useNavigate","FriendSinglePost","postId","comments","like","setLike","name","setName","comment","setComment","commentError","setCommentError","authorId","setAuthorId","description","setDescription","image","setImage","navigate","commentData","likeData","get","then","data","author","catch","e","console","log","Number","length","handleLike","preventDefault","append","post","response","window","location","reload","displayName","toOtherUser","state","id","handleComment","event","target","value","handleSend"],"sources":["/Users/heyuting/404lab/404_project/WebApplicationProject/src/components/Post/FriendSinglePost.jsx"],"sourcesContent":["import React, { useState, useEffect, useCallback } from \"react\";\nimport Form from \"./Form\";\nimport SendIcon from '@mui/icons-material/Send';\nimport './SinglePost.css'\nimport axios from \"axios\";\nimport FormData from 'form-data'\nimport { useNavigate } from 'react-router-dom';\n\nconst FriendSinglePost = ({ postId, comments }) => {\n    const [like, setLike] = useState(0);\n    const [name, setName] = useState('');\n    const [comment, setComment] = useState('');\n    const [commentError, setCommentError] = useState('');\n    const [authorId, setAuthorId] = useState('');\n    const [description, setDescription] = useState('');\n    const [image, setImage] = useState('');\n    const navigate = useNavigate();\n    let commentData = new FormData();\n    let likeData = new FormData();\n\n    useEffect(() => {\n        axios\n            .get(`${postId}/`)\n            .then((data) => {\n                setAuthorId(data.data.author)\n                setDescription(data.data.description)\n            })\n            .catch((e) => console.log(e));\n        axios\n            .get(`${postId}/likes`)\n            .then((data) => {\n                setLike(Number(data.data.length))\n            })\n            .catch((e) => console.log(e));\n    }, [authorId, description, like])\n\n\n    const handleLike = useCallback(\n        async (e) => {\n            e.preventDefault()\n            likeData.append('context', \"Charlote likes your post.\")\n            likeData.append('summary', authorId)\n            axios\n                .post(`${postId}/likes`, likeData)\n                .then((response) => {\n                    console.log(response);\n                    window.location.reload()\n                })\n                .catch((e) => {\n                    console.log(e);\n                });\n        },\n        [authorId]\n    )\n\n    axios\n        .get(`${authorId}`)\n        .then((data) => {\n            setName(data.data.displayName)\n        })\n        .catch((e) => console.log(e));\n\n    const toOtherUser = () => {\n        navigate('./otherProfile', { state: { id: authorId } });\n    }\n\n    const handleComment = useCallback((event) => {\n        setComment(event.target.value)\n        setCommentError('')\n    }, [])\n\n    const handleSend = useCallback(async (e) => {\n        e.preventDefault()\n        if (!comment) {\n            setCommentError(\"*Cannot send an empty comment!\")\n        }\n        else {\n            commentData.append('content', comment)\n            axios\n                .post(`${postId}/comments`, commentData)\n                .then((response) => {\n                    console.log(response);\n                    window.location.reload()\n                })\n                .catch((e) => {\n                    console.log(e);\n                });\n        }\n    })\n\n    return (\n        <div className=\"singlePost\">\n            <a className=\"userName\" onClick={() => { toOtherUser() }}>@{name}:</a>\n            <p className=\"singleDes\">{description}</p>\n            <div className='center'>\n                <img className='postImage' src={image} />\n            </div>\n            <div className=\"postBar\">\n                <Form\n                    type=\"text\"\n                    name=\"comment\"\n                    onchange={handleComment}\n                    placeholder=\"leave your comment\"\n                ></Form>\n                <button className=\"eds\" onClick={handleSend}>\n                    <SendIcon />\n                </button>\n                <button className=\"like\" onClick={handleLike}>\n                    Like {like}\n                </button>\n            </div>\n            <p className=\"flash\">{commentError}</p>\n            <div> {comments}</div>\n        </div>\n    )\n}\nexport default FriendSinglePost"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}