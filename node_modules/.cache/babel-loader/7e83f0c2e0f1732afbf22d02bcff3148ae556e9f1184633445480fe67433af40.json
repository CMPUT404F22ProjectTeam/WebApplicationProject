{"ast":null,"code":"var _jsxFileName = \"/Users/heyuting/404lab/404_project/WebApplicationProject/src/components/Post/FriendSinglePost.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback } from \"react\";\nimport Form from \"./Form\";\nimport SendIcon from '@mui/icons-material/Send';\nimport './SinglePost.css';\nimport axios from \"axios\";\nimport FormData from 'form-data';\nimport { useNavigate } from 'react-router-dom';\nimport FavoriteBorderIcon from '@mui/icons-material/FavoriteBorder';\nimport { Cookies } from 'react-cookie';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst base_url = process.env.REACT_APP_CURRENT_URL;\nconst FriendSinglePost = _ref => {\n  _s();\n  let {\n    author,\n    displayName,\n    postId,\n    comments,\n    title,\n    content,\n    description\n  } = _ref;\n  const cookies = new Cookies();\n  const My_ID = cookies.get('id').split(\"/\").pop();\n  const My_Name = cookies.get('username');\n  const [like, setLike] = useState(0);\n  const [name, setName] = useState(displayName);\n  const [comment, setComment] = useState('');\n  const [commentError, setCommentError] = useState('');\n  const [image, setImage] = useState('');\n  const navigate = useNavigate();\n  let commentData = new FormData();\n  let likeData = new FormData();\n  let id = String(postId).split(\"/\").pop();\n  let me = cookies.get('id');\n  useEffect(() => {\n    axios.get(`${postId}/likes`).then(data => {\n      setLike(Number(data.data.length));\n    }).catch(e => console.log(e));\n    /*\n    axios\n        .get(`${author}`)\n        .then((data) => {\n            setName(data.data.displayName)\n        })\n        .catch((e) => console.log(e));\n        */\n  }, [name, like]);\n  const handleLike = useCallback(async e => {\n    e.preventDefault();\n    likeData.append('context', {\n      My_Name\n    } + \" likes your post.\");\n    likeData.append('summary', {\n      My_Name\n    } + \" likes your post.\");\n    likeData.append('author', me);\n    likeData.append('post', id);\n    likeData.append('object', \"/authors/\" + {\n      My_ID\n    } + \"/posts/\" + {\n      id\n    });\n    if (author.includes('cmput404team18-backend') === true) {\n      axios.post(`${base_url}/authors/${My_ID}/inbox/like`, likeData).then(response => {\n        console.log(response);\n        //window.location.reload()\n      }).catch(e => {\n        console.log(e);\n      });\n    } else {\n      axios.post(`${postId}/likes`, likeData).then(response => {\n        console.log(response);\n        window.location.reload();\n      }).catch(e => {\n        console.log(e);\n      });\n    }\n  }, [author]);\n  const toOtherUser = () => {\n    navigate('/otherProfile', {\n      state: {\n        id: author\n      }\n    });\n  };\n  const handleComment = useCallback(event => {\n    setComment(event.target.value);\n    setCommentError('');\n  }, []);\n  const handleSend = useCallback(async e => {\n    e.preventDefault();\n    if (!comment) {\n      setCommentError(\"*Cannot send an empty comment!\");\n    } else {\n      commentData.append('content', comment);\n      axios.post(`${postId}/comments`, commentData).then(response => {\n        console.log(response);\n      }).catch(e => {\n        console.log(e);\n      });\n    }\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"singlePost\",\n    children: [/*#__PURE__*/_jsxDEV(\"a\", {\n      className: \"userName\",\n      onClick: () => {\n        toOtherUser();\n      },\n      children: [\"@\", displayName, \":\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"singleTit\",\n      children: title\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"singleDes\",\n      children: description\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"center\",\n      children: content.includes(\"image\") && /*#__PURE__*/_jsxDEV(\"img\", {\n        className: \"postContent\",\n        src: `data:image;base64,${content.split(\",\")[1]}`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 48\n      }, this) || /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"single-content\",\n        children: content\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 135\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"postBar\",\n      children: [/*#__PURE__*/_jsxDEV(Form, {\n        type: \"text\",\n        name: \"comment\",\n        onchange: handleComment,\n        placeholder: \"leave your comment\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"eds\",\n        onClick: handleSend,\n        children: /*#__PURE__*/_jsxDEV(SendIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"like\",\n        onClick: handleLike,\n        children: [/*#__PURE__*/_jsxDEV(FavoriteBorderIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 21\n        }, this), \" \", like]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"flash\",\n      children: commentError\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [\" \", comments]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 106,\n    columnNumber: 9\n  }, this);\n};\n_s(FriendSinglePost, \"iu7qzFTQy8E0DyVf0QKrdOC27j4=\", false, function () {\n  return [useNavigate];\n});\n_c = FriendSinglePost;\nexport default FriendSinglePost;\nvar _c;\n$RefreshReg$(_c, \"FriendSinglePost\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","Form","SendIcon","axios","FormData","useNavigate","FavoriteBorderIcon","Cookies","base_url","process","env","REACT_APP_CURRENT_URL","FriendSinglePost","author","displayName","postId","comments","title","content","description","cookies","My_ID","get","split","pop","My_Name","like","setLike","name","setName","comment","setComment","commentError","setCommentError","image","setImage","navigate","commentData","likeData","id","String","me","then","data","Number","length","catch","e","console","log","handleLike","preventDefault","append","includes","post","response","window","location","reload","toOtherUser","state","handleComment","event","target","value","handleSend"],"sources":["/Users/heyuting/404lab/404_project/WebApplicationProject/src/components/Post/FriendSinglePost.jsx"],"sourcesContent":["import React, { useState, useEffect, useCallback } from \"react\";\nimport Form from \"./Form\";\nimport SendIcon from '@mui/icons-material/Send';\nimport './SinglePost.css'\nimport axios from \"axios\";\nimport FormData from 'form-data'\nimport { useNavigate } from 'react-router-dom';\nimport FavoriteBorderIcon from '@mui/icons-material/FavoriteBorder';\nimport { Cookies } from 'react-cookie';\n\nconst base_url = process.env.REACT_APP_CURRENT_URL;\n\nconst FriendSinglePost = ({ author, displayName, postId, comments, title, content, description }) => {\n    const cookies = new Cookies();\n    const My_ID = cookies.get('id').split(\"/\").pop();\n    const My_Name = cookies.get('username')\n    const [like, setLike] = useState(0);\n    const [name, setName] = useState(displayName);\n    const [comment, setComment] = useState('');\n    const [commentError, setCommentError] = useState('');\n    const [image, setImage] = useState('');\n    const navigate = useNavigate();\n    let commentData = new FormData();\n    let likeData = new FormData();\n    let id = String(postId).split(\"/\").pop();\n    let me = cookies.get('id')\n\n    useEffect(() => {\n        axios\n            .get(`${postId}/likes`)\n            .then((data) => {\n                setLike(Number(data.data.length))\n            })\n            .catch((e) => console.log(e));\n        /*\n        axios\n            .get(`${author}`)\n            .then((data) => {\n                setName(data.data.displayName)\n            })\n            .catch((e) => console.log(e));\n            */\n    }, [name, like])\n\n    const handleLike = useCallback(\n        async (e) => {\n            e.preventDefault()\n            likeData.append('context', { My_Name } + \" likes your post.\")\n            likeData.append('summary', { My_Name } + \" likes your post.\")\n            likeData.append('author', me)\n            likeData.append('post', id)\n            likeData.append('object', \"/authors/\" + { My_ID } + \"/posts/\" + { id })\n            if (author.includes('cmput404team18-backend') === true) {\n                axios\n                    .post(`${base_url}/authors/${My_ID}/inbox/like`, likeData)\n                    .then((response) => {\n                        console.log(response);\n                        //window.location.reload()\n                    })\n                    .catch((e) => {\n                        console.log(e);\n                    });\n            } else {\n                axios\n                    .post(`${postId}/likes`, likeData)\n                    .then((response) => {\n                        console.log(response);\n                        window.location.reload()\n                    })\n                    .catch((e) => {\n                        console.log(e);\n                    });\n            }\n        },\n        [author]\n    )\n\n    const toOtherUser = () => {\n        navigate('/otherProfile', { state: { id: author } });\n    }\n\n    const handleComment = useCallback((event) => {\n        setComment(event.target.value)\n        setCommentError('')\n    }, [])\n\n    const handleSend = useCallback(async (e) => {\n        e.preventDefault()\n        if (!comment) {\n            setCommentError(\"*Cannot send an empty comment!\")\n        }\n        else {\n            commentData.append('content', comment)\n            axios\n                .post(`${postId}/comments`, commentData)\n                .then((response) => {\n                    console.log(response);\n                })\n                .catch((e) => {\n                    console.log(e);\n                });\n        }\n    })\n\n    return (\n        <div className=\"singlePost\">\n            <a className=\"userName\" onClick={() => { toOtherUser() }}>@{displayName}:</a>\n            <p className=\"singleTit\">{title}</p>\n            <p className=\"singleDes\">{description}</p>\n            <div className='center'>\n                {content.includes(\"image\") && (<img className='postContent' src={`data:image;base64,${content.split(\",\")[1]}`} />) || <p className='single-content'>{content}</p>}\n            </div>\n            <div className=\"postBar\">\n                <Form\n                    type=\"text\"\n                    name=\"comment\"\n                    onchange={handleComment}\n                    placeholder=\"leave your comment\"\n                ></Form>\n                <button className=\"eds\" onClick={handleSend}>\n                    <SendIcon />\n                </button>\n                <button className=\"like\" onClick={handleLike}>\n                    <FavoriteBorderIcon /> {like}\n                </button>\n            </div>\n            <p className=\"flash\">{commentError}</p>\n            <div> {comments}</div>\n        </div>\n    )\n}\nexport default FriendSinglePost"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}